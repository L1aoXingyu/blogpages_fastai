<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>CSAPP 之 Bomb Lab | Distill</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="CSAPP 之 Bomb Lab" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="记录在阅读和学习 CSAPP 过程中，完成 BombLab 的相关内容" />
<meta property="og:description" content="记录在阅读和学习 CSAPP 过程中，完成 BombLab 的相关内容" />
<link rel="canonical" href="https://l1aoxingyu.github.io/blogpages/operation%20system/c/csapp/assembly/2022/02/13/csapp-bomb.html" />
<meta property="og:url" content="https://l1aoxingyu.github.io/blogpages/operation%20system/c/csapp/assembly/2022/02/13/csapp-bomb.html" />
<meta property="og:site_name" content="Distill" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-13T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://l1aoxingyu.github.io/blogpages/operation%20system/c/csapp/assembly/2022/02/13/csapp-bomb.html","@type":"BlogPosting","headline":"CSAPP 之 Bomb Lab","dateModified":"2022-02-13T00:00:00-06:00","datePublished":"2022-02-13T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://l1aoxingyu.github.io/blogpages/operation%20system/c/csapp/assembly/2022/02/13/csapp-bomb.html"},"description":"记录在阅读和学习 CSAPP 过程中，完成 BombLab 的相关内容","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blogpages/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://l1aoxingyu.github.io/blogpages/feed.xml" title="Distill" /><link rel="shortcut icon" type="image/x-icon" href="/blogpages/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blogpages/">Distill</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blogpages/about/">About Me</a><a class="page-link" href="/blogpages/search/">Search</a><a class="page-link" href="/blogpages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">CSAPP 之 Bomb Lab</h1><p class="page-description">记录在阅读和学习 CSAPP 过程中，完成 BombLab 的相关内容</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-02-13T00:00:00-06:00" itemprop="datePublished">
        Feb 13, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      14 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blogpages/categories/#operation system">operation system</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blogpages/categories/#c">c</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blogpages/categories/#csapp">csapp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blogpages/categories/#assembly">assembly</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#0x0-introduction">0x0 Introduction</a></li>
<li class="toc-entry toc-h3"><a href="#0x1-实验阶段">0x1 实验阶段</a>
<ul>
<li class="toc-entry toc-h4"><a href="#0x11-phase_1">0x1.1 phase_1</a></li>
<li class="toc-entry toc-h4"><a href="#0x12-phase_2">0x1.2 phase_2</a></li>
<li class="toc-entry toc-h4"><a href="#0x13-phase_3">0x1.3 phase_3</a></li>
<li class="toc-entry toc-h4"><a href="#0x14-phase_4">0x1.4 phase_4</a></li>
<li class="toc-entry toc-h4"><a href="#0x15-phase_5">0x1.5 phase_5</a></li>
<li class="toc-entry toc-h4"><a href="#0x16-phase_6">0x1.6 phase_6</a></li>
<li class="toc-entry toc-h4"><a href="#0x17-secret_phase">0x1.7 secret_phase</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#0x2-结语">0x2 结语</a></li>
<li class="toc-entry toc-h3"><a href="#0x3-reference">0x3 Reference</a></li>
</ul><h3 id="0x0-introduction">
<a class="anchor" href="#0x0-introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x0 Introduction</h3>

<p>该实验提供了一个 “binary bomb”，这是一个编译好的二进制程序，在运行过程中需要用户提供 6 次输入，如果有任何一次不正确，炸弹就会爆炸。</p>

<p>在这个实验中，我们需要做逆向工程对炸弹进行拆解，对这个二进制程序进行反汇编后，通过阅读他的汇编代码，获取需要输入的 6 个字符串是什么。</p>

<p>在这次实验中，主要使用的工具如下：</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">objdump</code>: 将二进制文件进行反汇编；</li>
  <li>
<code class="language-plaintext highlighter-rouge">vscode</code>：阅读和注解汇编代码的编辑器；</li>
  <li>
<code class="language-plaintext highlighter-rouge">cgdb(gdb)</code>：单步调试汇编代码的 debugger；</li>
</ul>

<p>通过下面的命令即可对二进制程序进行反汇编，最终获得 <code class="language-plaintext highlighter-rouge">bomb.asm</code> 代码，还可以在 vscode 中安装 asm 插件实现代码的高亮。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objdump bomb <span class="nt">-d</span> <span class="o">&gt;</span> bomb.asm
</code></pre></div></div>

<p><img src="/blogpages/images/csapp-bomb/bomb_preview.png" width="700"></p>

<h3 id="0x1-实验阶段">
<a class="anchor" href="#0x1-%E5%AE%9E%E9%AA%8C%E9%98%B6%E6%AE%B5" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1 实验阶段</h3>

<h4 id="0x11-phase_1">
<a class="anchor" href="#0x11-phase_1" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.1 phase_1</h4>

<p>下面的 c 代码包含了第一阶段的所有内容</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* Hmm...  Six phases must be more secure than one phase! */</span>
<span class="n">input</span> <span class="o">=</span> <span class="n">read_line</span><span class="p">();</span>             <span class="cm">/* Get input                   */</span>
<span class="n">phase_1</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>                  <span class="cm">/* Run the phase               */</span>
<span class="n">phase_defused</span><span class="p">();</span>                 <span class="cm">/* Drat!  They figured it out!
            * Let me know how they did it. */</span>
<span class="cm">/* Border relations with Canada have never been better. */</span>
</code></pre></div></div>

<p>代码非常简单，程序读取输入之后，送到 <code class="language-plaintext highlighter-rouge">phase_1</code> 这个函数中进行处理，如果函数顺利退出则表示炸弹被拆掉，输入指令正确。</p>

<p>通过在汇编代码中搜索 <code class="language-plaintext highlighter-rouge">phase_1</code> 即可找到其在汇编代码中的片段</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0000000000400</span><span class="nx">ee0</span> <span class="o">&lt;</span><span class="nx">phase_1</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="mi">400</span><span class="nx">ee0</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">ec</span> <span class="mi">08</span>          	<span class="nx">sub</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">400</span><span class="nx">ee4</span><span class="p">:</span>	<span class="nx">be</span> <span class="mi">00</span> <span class="mi">24</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x402400</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">400</span><span class="nx">ee9</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">4</span><span class="nx">a</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">401338</span> <span class="o">&lt;</span><span class="nx">strings_not_equal</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">eee</span><span class="p">:</span>	<span class="mi">85</span> <span class="nx">c0</span>                	<span class="nx">test</span>   <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">ef0</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">05</span>                	<span class="nx">je</span>     <span class="mi">400</span><span class="nx">ef7</span> <span class="o">&lt;</span><span class="nx">phase_1</span><span class="o">+</span><span class="mh">0x17</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">ef2</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">43</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">ef7</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">08</span>          	<span class="nx">add</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">400</span><span class="nx">efb</span><span class="p">:</span>	<span class="nx">c3</span>                   	<span class="nx">retq</span>   
</code></pre></div></div>

<p>简单阅读这一段汇编代码，主要是调用了 <code class="language-plaintext highlighter-rouge">strings_not_equal</code> 这个函数，而通过名字可以大概了解这就是一个判断字符串是否相等的函数。</p>

<p>而上面有一段代码将地址 <code class="language-plaintext highlighter-rouge">0x402400</code> 移动到寄存器 <code class="language-plaintext highlighter-rouge">%esi</code> 中，通过查表可以了解到 <code class="language-plaintext highlighter-rouge">%esi</code> 是函数的第二个参数，而调用 <code class="language-plaintext highlighter-rouge">phase_1</code> 时，汇编代码如下，发现是通过 <code class="language-plaintext highlighter-rouge">read_line</code> 这个函数，将用户输入的结果移动到寄存器 <code class="language-plaintext highlighter-rouge">%rdi</code> 中，而这恰好是函数的第一个参数，所以可以得到第一阶段即要对比用户输入的字符串和 <code class="language-plaintext highlighter-rouge">0x402400</code> 这个地址存放的字符串是否相等。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">400</span><span class="nx">e32</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">67</span> <span class="mi">06</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40149</span><span class="nx">e</span> <span class="o">&lt;</span><span class="nx">read_line</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">e37</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">c7</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">400</span><span class="nx">e3a</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">a1</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">ee0</span> <span class="o">&lt;</span><span class="nx">phase_1</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>通过 <code class="language-plaintext highlighter-rouge">cgdb</code> 启动程序，在 <code class="language-plaintext highlighter-rouge">phase_1</code> 处打断点，注意这里断点需要打到汇编代码中，可以直接通过 <code class="language-plaintext highlighter-rouge">b phase_1</code> 打断点，也可以通过地址进行打断点，比如 <code class="language-plaintext highlighter-rouge">b *0x400ee0</code>，接着直接运行。</p>

<p>在 gdb 中通过 <code class="language-plaintext highlighter-rouge">ni</code> 可以在汇编代码中进行单步运行，我们可以运行到 <code class="language-plaintext highlighter-rouge">strings_not_equal</code> 这个函数调用前，接着通过 <code class="language-plaintext highlighter-rouge">p (char*)0x402400</code> 即可获得这个地址对应的字符串如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">p</span> <span class="p">(</span><span class="nx">char</span><span class="o">*</span><span class="p">)(</span><span class="mh">0x402400</span><span class="p">)</span>
<span class="nx">$6</span> <span class="o">=</span> <span class="mh">0x402400</span> <span class="dl">"</span><span class="s2">Border relations with Canada have never been better.</span><span class="dl">"</span>
</code></pre></div></div>

<p>接着可以尝试在 <code class="language-plaintext highlighter-rouge">phase_1</code> 输入这段字符串，可以获得下面的结果，说明 <code class="language-plaintext highlighter-rouge">pahse_1</code> 的输入指令正确，炸弹已经成功拆除了。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Phase</span> <span class="mi">1</span> <span class="nx">defused</span><span class="p">.</span> <span class="nx">How</span> <span class="nx">about</span> <span class="nx">the</span> <span class="nx">next</span> <span class="nx">one</span><span class="p">?</span>
</code></pre></div></div>

<h4 id="0x12-phase_2">
<a class="anchor" href="#0x12-phase_2" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.2 phase_2</h4>

<p>接着需要输入第二段字符，首先可以通过 <code class="language-plaintext highlighter-rouge">b phase_2</code> 直接在第二阶段开始时打上断点，然后随意输入一段字符以进入这个函数。</p>

<p>通过下面的汇编代码片段，发现调用了函数 <code class="language-plaintext highlighter-rouge">read_six_numbers</code>，其实通过函数名就可以发现这个函数需要输入 6 个数字，接着紧跟着的代码是执行 <code class="language-plaintext highlighter-rouge">cmpl $0x1, (%rsp)</code>，如果相等直接跳到 <code class="language-plaintext highlighter-rouge">0x400f30</code>，否则会调用 <code class="language-plaintext highlighter-rouge">explode_bomb</code>，这说明了要求输入的第一个数字必须是 1，否则炸弹会爆炸。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0000000000400</span><span class="nx">efc</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="mi">400</span><span class="nx">efc</span><span class="p">:</span>	<span class="mi">55</span>                   	<span class="nx">push</span>   <span class="o">%</span><span class="nx">rbp</span>
  <span class="mi">400</span><span class="nx">efd</span><span class="p">:</span>	<span class="mi">53</span>                   	<span class="nx">push</span>   <span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">400</span><span class="nx">efe</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">ec</span> <span class="mi">28</span>          	<span class="nx">sub</span>    <span class="nx">$0x28</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">400</span><span class="nx">f02</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">e6</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rsi</span>
  <span class="mi">400</span><span class="nx">f05</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">52</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40145</span><span class="nx">c</span> <span class="o">&lt;</span><span class="nx">read_six_numbers</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f0a</span><span class="p">:</span>	<span class="mi">83</span> <span class="mi">3</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">01</span>          	<span class="nx">cmpl</span>   <span class="nx">$0x1</span><span class="p">,(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">400</span><span class="nx">f0e</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">20</span>                	<span class="nx">je</span>     <span class="mi">400</span><span class="nx">f30</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x34</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f10</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">25</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f15</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">19</span>                	<span class="nx">jmp</span>    <span class="mi">400</span><span class="nx">f30</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x34</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>为了进一步确定 <code class="language-plaintext highlighter-rouge">read_six_numbers</code> 是要求我们输入 6 个数字，我们搜索对应的函数名，可以获得下面的汇编代码段</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">000000000040145</span><span class="nx">c</span> <span class="o">&lt;</span><span class="nx">read_six_numbers</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="mi">40145</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">ec</span> <span class="mi">18</span>          	<span class="nx">sub</span>    <span class="nx">$0x18</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">401460</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">f2</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="o">%</span><span class="nx">rdx</span>
  <span class="mi">401463</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">4</span><span class="nx">e</span> <span class="mi">04</span>          	<span class="nx">lea</span>    <span class="mh">0x4</span><span class="p">(</span><span class="o">%</span><span class="nx">rsi</span><span class="p">),</span><span class="o">%</span><span class="nx">rcx</span>
  <span class="mi">401467</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">46</span> <span class="mi">14</span>          	<span class="nx">lea</span>    <span class="mh">0x14</span><span class="p">(</span><span class="o">%</span><span class="nx">rsi</span><span class="p">),</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">40146</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">08</span>       	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">401470</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">46</span> <span class="mi">10</span>          	<span class="nx">lea</span>    <span class="mh">0x10</span><span class="p">(</span><span class="o">%</span><span class="nx">rsi</span><span class="p">),</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">401474</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="mi">04</span> <span class="mi">24</span>          	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rax</span><span class="p">,(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">401478</span><span class="p">:</span>	<span class="mi">4</span><span class="nx">c</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">4</span><span class="nx">e</span> <span class="mi">0</span><span class="nx">c</span>          	<span class="nx">lea</span>    <span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="nx">rsi</span><span class="p">),</span><span class="o">%</span><span class="nx">r9</span>
  <span class="mi">40147</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">4</span><span class="nx">c</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">46</span> <span class="mi">08</span>          	<span class="nx">lea</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsi</span><span class="p">),</span><span class="o">%</span><span class="nx">r8</span>
  <span class="mi">401480</span><span class="p">:</span>	<span class="nx">be</span> <span class="nx">c3</span> <span class="mi">25</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x4025c3</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">401485</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40148</span><span class="nx">a</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">61</span> <span class="nx">f7</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">bf0</span> <span class="o">&lt;</span><span class="nx">__isoc99_sscanf</span><span class="p">@</span><span class="nd">plt</span><span class="o">&gt;</span>
  <span class="mi">40148</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">05</span>             	<span class="nx">cmp</span>    <span class="nx">$0x5</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401492</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">f</span> <span class="mi">05</span>                	<span class="nx">jg</span>     <span class="mi">401499</span> <span class="o">&lt;</span><span class="nx">read_six_numbers</span><span class="o">+</span><span class="mh">0x3d</span><span class="o">&gt;</span>
  <span class="mi">401494</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">a1</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">401499</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">18</span>          	<span class="nx">add</span>    <span class="nx">$0x18</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">40149</span><span class="nx">d</span><span class="p">:</span>	<span class="nx">c3</span>                   	<span class="nx">retq</span>   
</code></pre></div></div>

<p>注意 <code class="language-plaintext highlighter-rouge">0x40148f</code> 对应的代码行，scanf 返回的结果和 5 进行比较，需要比 5 大，否则炸弹会爆炸。</p>

<p>接着代码会跳到 <code class="language-plaintext highlighter-rouge">0x400f30</code>，继续往下找对应的代码，会发现这一段代码比较重要。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">400</span><span class="nx">f17</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">43</span> <span class="nx">fc</span>             	<span class="nx">mov</span>    <span class="o">-</span><span class="mh">0x4</span><span class="p">(</span><span class="o">%</span><span class="nx">rbx</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>    
  <span class="mi">400</span><span class="nx">f1a</span><span class="p">:</span>	<span class="mi">01</span> <span class="nx">c0</span>                	<span class="nx">add</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">f1c</span><span class="p">:</span>	<span class="mi">39</span> <span class="mi">03</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,(</span><span class="o">%</span><span class="nx">rbx</span><span class="p">)</span>
  <span class="mi">400</span><span class="nx">f1e</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">05</span>                	<span class="nx">je</span>     <span class="mi">400</span><span class="nx">f25</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x29</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f20</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">15</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f25</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c3</span> <span class="mi">04</span>          	<span class="nx">add</span>    <span class="nx">$0x4</span><span class="p">,</span><span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">400</span><span class="nx">f29</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">39</span> <span class="nx">eb</span>             	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">rbp</span><span class="p">,</span><span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">400</span><span class="nx">f2c</span><span class="p">:</span>	<span class="mi">75</span> <span class="nx">e9</span>                	<span class="nx">jne</span>    <span class="mi">400</span><span class="nx">f17</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x1b</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f2e</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">0</span><span class="nx">c</span>                	<span class="nx">jmp</span>    <span class="mi">400</span><span class="nx">f3c</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x40</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">f30</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">5</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">04</span>       	<span class="nx">lea</span>    <span class="mh">0x4</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">400</span><span class="nx">f35</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">6</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">18</span>       	<span class="nx">lea</span>    <span class="mh">0x18</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rbp</span>
  <span class="mi">400</span><span class="nx">f3a</span><span class="p">:</span>	<span class="nx">eb</span> <span class="nx">db</span>                	<span class="nx">jmp</span>    <span class="mi">400</span><span class="nx">f17</span> <span class="o">&lt;</span><span class="nx">phase_2</span><span class="o">+</span><span class="mh">0x1b</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>其中 <code class="language-plaintext highlighter-rouge">(%rsp)</code> 表示第一个输入的数字，因为是 int 类型，所以内存中占用的长度是** 4 个字节**，那么<code class="language-plaintext highlighter-rouge">0x4(%rsx)</code> 表示第二个输入的数字，<code class="language-plaintext highlighter-rouge">0x18(%rsp)</code> 并不是表示第六个输入的数字，而是表示第六个数字之后的地址，后面会讲为什么需要这样设置。</p>

<p>可以发现代码又跳转到 <code class="language-plaintext highlighter-rouge">0x400f17</code> 地址，首先 <code class="language-plaintext highlighter-rouge">mov  -0x4(%rbx),%eax</code> 即可将第一个输入的数字放到寄存器 <code class="language-plaintext highlighter-rouge">%eax</code> 中，然后 <code class="language-plaintext highlighter-rouge">add %eax,%eax</code> 其实就是将数字<code class="language-plaintext highlighter-rouge">*2</code>，然后判断 <code class="language-plaintext highlighter-rouge">%eax</code> 和 <code class="language-plaintext highlighter-rouge">(%rbx)</code> 是否相等，如果不相等则炸弹会爆炸，由此可以看出我们需要输入 6 个数字，第一个是 1，然后每一个后面的数字都是前面数字的两倍。</p>

<p>最后可以通过 <code class="language-plaintext highlighter-rouge">add $0x4,%rbx</code> 不断遍历下一个元素，然后通过 <code class="language-plaintext highlighter-rouge">%rbp</code> 和 <code class="language-plaintext highlighter-rouge">%rbx</code> 是否相等的判断来决定跳出循环，注意 <code class="language-plaintext highlighter-rouge">(%rsp)</code> 表示第一个数字，那么<code class="language-plaintext highlighter-rouge">0x14(%rsp)</code>表示第六个数字，所以<code class="language-plaintext highlighter-rouge">0x18(%rsp)</code>表示第六个数字之后的地址，通过和这个地址作比较，可以确保遍历完所有的 6 个数字。</p>

<p>最后这 6 个数字为 <code class="language-plaintext highlighter-rouge">1 2 4 8 16 32</code>，输入这些数字即可解除第二阶段的炸弹。</p>

<h4 id="0x13-phase_3">
<a class="anchor" href="#0x13-phase_3" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.3 phase_3</h4>

<p>接着需要输入第三段字符，首先可以通过 <code class="language-plaintext highlighter-rouge">b phase_3</code> 直接在第三阶段开始的时候打上断点，然后输入一段字符以进入这个函数。</p>

<p>通过阅读下面这段汇编代码，可以发现，<code class="language-plaintext highlighter-rouge">scanf</code> 的返回值需要大于<code class="language-plaintext highlighter-rouge">1</code>，否则炸弹就会爆炸，这也就是说至少需要输入<code class="language-plaintext highlighter-rouge">2</code>个数字。</p>

<p>接着继续查看下面的代码，发现需要比较 <code class="language-plaintext highlighter-rouge">$0x7</code> 和 <code class="language-plaintext highlighter-rouge">0x8(%rsp)</code>，通过 <code class="language-plaintext highlighter-rouge">x (%rsp+0x8)</code> ，可以发现<code class="language-plaintext highlighter-rouge">0x8(%rsp)</code> 表示第一个数字的地址，进一步可以发现 <code class="language-plaintext highlighter-rouge">0xc(%rsp)</code>表示第二个数字的地址，地址差距是 4 个字节，说明是 int32 的数据类型。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">400</span><span class="nx">f6a</span><span class="p">:</span>	<span class="mi">83</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">08</span> <span class="mi">07</span>       	<span class="nx">cmpl</span>   <span class="nx">$0x7</span><span class="p">,</span><span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">400</span><span class="nx">f6f</span><span class="p">:</span>	<span class="mi">77</span> <span class="mi">3</span><span class="nx">c</span>                	<span class="nx">ja</span>     <span class="mi">400</span><span class="nx">fad</span> <span class="o">&lt;</span><span class="nx">phase_3</span><span class="o">+</span><span class="mh">0x6a</span><span class="o">&gt;</span>
  <span class="p">...</span>
  <span class="mi">400</span><span class="nx">fad</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">88</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>所以这一段代码即表示如果输入的第一个参数比<code class="language-plaintext highlighter-rouge">7</code>大，则会跳到 <code class="language-plaintext highlighter-rouge">0x400fad</code> 这个位置继续执行，而这个位置执行的函数为 <code class="language-plaintext highlighter-rouge">explode_bomb</code>，这也就是间接说明了需要输入的第一个数字<code class="language-plaintext highlighter-rouge">&lt;=7</code>。</p>

<p>接着继续执行下面的代码，首先将第一个数字放到寄存器 <code class="language-plaintext highlighter-rouge">$eax</code> 中，然后执行 <code class="language-plaintext highlighter-rouge">jmpq</code> 指令，跳转的地址是 <code class="language-plaintext highlighter-rouge">0x402470 + 8 * $rax</code> 位置的指针指向的内容，这里我们可以通过在 <code class="language-plaintext highlighter-rouge">gdb</code> 中输入 <code class="language-plaintext highlighter-rouge">ni</code> 进行单步执行，来判断最终代码跳转的位置，如果输入的第一个数字是<code class="language-plaintext highlighter-rouge">1</code>，那么也可以通过<code class="language-plaintext highlighter-rouge">p/x *(0x402470+8)</code>或者是 <code class="language-plaintext highlighter-rouge">x/x 0x402470+8</code> 来计算出具体的位置。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">400</span><span class="nx">f71</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">f75</span><span class="p">:</span>	<span class="nx">ff</span> <span class="mi">24</span> <span class="nx">c5</span> <span class="mi">70</span> <span class="mi">24</span> <span class="mi">40</span> <span class="mi">00</span> 	<span class="nx">jmpq</span>   <span class="o">*</span><span class="mh">0x402470</span><span class="p">(,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</code></pre></div></div>

<p>接着直接跳到对应的位置去查看代码，可以发现下面的代码需要比较输入的第二个数字和 <code class="language-plaintext highlighter-rouge">0x137</code> 的大小，因为首先通过 <code class="language-plaintext highlighter-rouge">mov $0x137,%eax</code> 将 <code class="language-plaintext highlighter-rouge">0x137</code> 移动到寄存器 <code class="language-plaintext highlighter-rouge">$eax</code> 中，然后通过 <code class="language-plaintext highlighter-rouge">cmp 0xc(%rsp),%eax</code> 来比较寄存器 <code class="language-plaintext highlighter-rouge">$eax</code> 的值以及地址 <code class="language-plaintext highlighter-rouge">0xc(%rsp)</code>  指向内存的值，从前面可以知道这是第二个输入的数字。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">400</span><span class="nx">fb9</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">37</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x137</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fbe</span><span class="p">:</span>	<span class="mi">3</span><span class="nx">b</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">0</span><span class="nx">c</span>          	<span class="nx">cmp</span>    <span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fc2</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">05</span>                	<span class="nx">je</span>     <span class="mi">400</span><span class="nx">fc9</span> <span class="o">&lt;</span><span class="nx">phase_3</span><span class="o">+</span><span class="mh">0x86</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">fc4</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">71</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>所以输入的第二个数字换成十进制则是 <code class="language-plaintext highlighter-rouge">311</code> ，于是输入 <code class="language-plaintext highlighter-rouge">1 311</code> 即可接触第三个炸弹，因为要求第一个数字 <code class="language-plaintext highlighter-rouge">&lt;=7</code>，所以这里只描述了一种可能性，也可以尝试第一个数字输入是<code class="language-plaintext highlighter-rouge">2</code>，会发现程序会跳到 <code class="language-plaintext highlighter-rouge">0x400f83</code>，需要输入的第二个数字是 <code class="language-plaintext highlighter-rouge">707</code>.</p>

<h4 id="0x14-phase_4">
<a class="anchor" href="#0x14-phase_4" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.4 phase_4</h4>

<p>下一个阶段主要考察了对递归函数的 reverse engineering，首先在 <code class="language-plaintext highlighter-rouge">phase_4</code> 开始阶段打上断点，然后运行进入，首先查看下面这段汇编代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">40101</span><span class="nx">a</span><span class="p">:</span>	<span class="nx">be</span> <span class="nx">cf</span> <span class="mi">25</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x4025cf</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">40101</span><span class="nx">f</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401024</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">c7</span> <span class="nx">fb</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">bf0</span> <span class="o">&lt;</span><span class="nx">__isoc99_sscanf</span><span class="p">@</span><span class="nd">plt</span><span class="o">&gt;</span>
  <span class="mi">401029</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">02</span>             	<span class="nx">cmp</span>    <span class="nx">$0x2</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40102</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">75</span> <span class="mi">07</span>                	<span class="nx">jne</span>    <span class="mi">401035</span> <span class="o">&lt;</span><span class="nx">phase_4</span><span class="o">+</span><span class="mh">0x29</span><span class="o">&gt;</span>
  <span class="mi">40102</span><span class="nx">e</span><span class="p">:</span>	<span class="mi">83</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">08</span> <span class="mi">0</span><span class="nx">e</span>       	<span class="nx">cmpl</span>   <span class="nx">$0xe</span><span class="p">,</span><span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">401033</span><span class="p">:</span>	<span class="mi">76</span> <span class="mi">05</span>                	<span class="nx">jbe</span>    <span class="mi">40103</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">phase_4</span><span class="o">+</span><span class="mh">0x2e</span><span class="o">&gt;</span>
  <span class="mi">401035</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">00</span> <span class="mi">04</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>可以发现需要我们通过 <code class="language-plaintext highlighter-rouge">scanf</code> 输入一些内容，通过在 <code class="language-plaintext highlighter-rouge">gdb</code> 中查看 <code class="language-plaintext highlighter-rouge">scanf</code> 需要的输入个数和类型如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">x</span> <span class="o">/</span><span class="nx">s</span> <span class="mh">0x4025cf</span>
<span class="mh">0x4025cf</span><span class="p">:</span>       <span class="dl">"</span><span class="s2">%d %d</span><span class="dl">"</span>
</code></pre></div></div>

<p>说明需要输入两个 <code class="language-plaintext highlighter-rouge">int</code> 类型的数字，同时通过 <code class="language-plaintext highlighter-rouge">cmp $0x2,%eax</code> 也可以证实这点，另外还通过 <code class="language-plaintext highlighter-rouge">cmpl $0xe,0x8(%rsp)</code> 要求输入的第一个数字必须要 <code class="language-plaintext highlighter-rouge">&lt;=14</code>，接着代码会跳到地址 <code class="language-plaintext highlighter-rouge">40103a</code> 继续执行。</p>

<p>然后查看对应位置的汇编代码，发现整体逻辑是调用 <code class="language-plaintext highlighter-rouge">func4</code>，判断返回值是否为<code class="language-plaintext highlighter-rouge">0</code>，如果不是 <code class="language-plaintext highlighter-rouge">0</code>，那么直接跳到 <code class="language-plaintext highlighter-rouge">0x401058</code> 就触发爆炸，如果是 <code class="language-plaintext highlighter-rouge">0</code> 则可以继续判断输入的第二个数字是否是 <code class="language-plaintext highlighter-rouge">0</code>，如果是 <code class="language-plaintext highlighter-rouge">0</code>，那么顺利解除炸弹。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">40103</span><span class="nx">a</span><span class="p">:</span>	<span class="nx">ba</span> <span class="mi">0</span><span class="nx">e</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0xe</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">40103</span><span class="nx">f</span><span class="p">:</span>	<span class="nx">be</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">401044</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">edi</span>
  <span class="mi">401048</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">81</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">fce</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">&gt;</span>
  <span class="mi">40104</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">85</span> <span class="nx">c0</span>                	<span class="nx">test</span>   <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40104</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">75</span> <span class="mi">07</span>                	<span class="nx">jne</span>    <span class="mi">401058</span> <span class="o">&lt;</span><span class="nx">phase_4</span><span class="o">+</span><span class="mh">0x4c</span><span class="o">&gt;</span>
  <span class="mi">401051</span><span class="p">:</span>	<span class="mi">83</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">0</span><span class="nx">c</span> <span class="mi">00</span>       	<span class="nx">cmpl</span>   <span class="nx">$0x0</span><span class="p">,</span><span class="mh">0xc</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">401056</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">05</span>                	<span class="nx">je</span>     <span class="mi">40105</span><span class="nx">d</span> <span class="o">&lt;</span><span class="nx">phase_4</span><span class="o">+</span><span class="mh">0x51</span><span class="o">&gt;</span>
  <span class="mi">401058</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">dd</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>看到这里，整体已经比较清晰了，输入两个数字，第一个需要不比 <code class="language-plaintext highlighter-rouge">14</code> 大，第二个必须是<code class="language-plaintext highlighter-rouge">0</code>，然后调用 <code class="language-plaintext highlighter-rouge">func4</code> 需要保证返回值是 <code class="language-plaintext highlighter-rouge">0</code>，而其输入的参数分别在寄存器 <code class="language-plaintext highlighter-rouge">%rdi, %rsi, %rdx</code>，继续分析这些寄存器的获得方法，可以发现，第一个参数就是我们输入的第一个数字，第二个参数是 <code class="language-plaintext highlighter-rouge">0</code>，第三个参数是 <code class="language-plaintext highlighter-rouge">14</code>，所以接下来只需要进一步分析 <code class="language-plaintext highlighter-rouge">func4</code> 即可。</p>

<p>在汇编代码中搜索 <code class="language-plaintext highlighter-rouge">func4</code> 即可找到对应的代码片段</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0000000000400</span><span class="nx">fce</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="mi">400</span><span class="nx">fce</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">ec</span> <span class="mi">08</span>          	<span class="nx">sub</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">400</span><span class="nx">fd2</span><span class="p">:</span>	<span class="mi">89</span> <span class="nx">d0</span>                	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">edx</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fd4</span><span class="p">:</span>	<span class="mi">29</span> <span class="nx">f0</span>                	<span class="nx">sub</span>    <span class="o">%</span><span class="nx">esi</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fd6</span><span class="p">:</span>	<span class="mi">89</span> <span class="nx">c1</span>                	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">400</span><span class="nx">fd8</span><span class="p">:</span>	<span class="nx">c1</span> <span class="nx">e9</span> <span class="mi">1</span><span class="nx">f</span>             	<span class="nx">shr</span>    <span class="nx">$0x1f</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">400</span><span class="nx">fdb</span><span class="p">:</span>	<span class="mi">01</span> <span class="nx">c8</span>                	<span class="nx">add</span>    <span class="o">%</span><span class="nx">ecx</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fdd</span><span class="p">:</span>	<span class="nx">d1</span> <span class="nx">f8</span>                	<span class="nx">sar</span>    <span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">fdf</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">0</span><span class="nx">c</span> <span class="mi">30</span>             	<span class="nx">lea</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">400</span><span class="nx">fe2</span><span class="p">:</span>	<span class="mi">39</span> <span class="nx">f9</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">edi</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">400</span><span class="nx">fe4</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">e</span> <span class="mi">0</span><span class="nx">c</span>                	<span class="nx">jle</span>    <span class="mi">400</span><span class="nx">ff2</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">+</span><span class="mh">0x24</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">fe6</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">51</span> <span class="nx">ff</span>             	<span class="nx">lea</span>    <span class="o">-</span><span class="mh">0x1</span><span class="p">(</span><span class="o">%</span><span class="nx">rcx</span><span class="p">),</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">400</span><span class="nx">fe9</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">e0</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">fce</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">fee</span><span class="p">:</span>	<span class="mi">01</span> <span class="nx">c0</span>                	<span class="nx">add</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">ff0</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">15</span>                	<span class="nx">jmp</span>    <span class="mi">401007</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">+</span><span class="mh">0x39</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">ff2</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">400</span><span class="nx">ff7</span><span class="p">:</span>	<span class="mi">39</span> <span class="nx">f9</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">edi</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">400</span><span class="nx">ff9</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">d</span> <span class="mi">0</span><span class="nx">c</span>                	<span class="nx">jge</span>    <span class="mi">401007</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">+</span><span class="mh">0x39</span><span class="o">&gt;</span>
  <span class="mi">400</span><span class="nx">ffb</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">71</span> <span class="mi">01</span>             	<span class="nx">lea</span>    <span class="mh">0x1</span><span class="p">(</span><span class="o">%</span><span class="nx">rcx</span><span class="p">),</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">400</span><span class="nx">ffe</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">cb</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">fce</span> <span class="o">&lt;</span><span class="nx">func4</span><span class="o">&gt;</span>
  <span class="mi">401003</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">44</span> <span class="mi">00</span> <span class="mi">01</span>          	<span class="nx">lea</span>    <span class="mh">0x1</span><span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401007</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">08</span>          	<span class="nx">add</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">40100</span><span class="nx">b</span><span class="p">:</span>	<span class="nx">c3</span>                   	<span class="nx">retq</span>   
</code></pre></div></div>

<p>整体代码并不长，但是里面有两处存在递归调用，如果使用 <code class="language-plaintext highlighter-rouge">gdb</code> 进行单步调试会比较绕，所以这里直接对汇编代码进行反向工程，获得对应的 c 代码如下</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">func4</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">a2</span> <span class="o">-</span> <span class="n">a1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">a1</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">func4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a2</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">func4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>因为该函数需要返回的值是 0，所以只能走 <code class="language-plaintext highlighter-rouge">n==x</code> 和 <code class="language-plaintext highlighter-rouge">n&gt;x</code> 这两个分支，否则会返回 <code class="language-plaintext highlighter-rouge">2*m+1</code>，那么结果必然不会是 <code class="language-plaintext highlighter-rouge">0</code>，而由前面知道 <code class="language-plaintext highlighter-rouge">a1=0, a2=14</code>，所以不断计算 <code class="language-plaintext highlighter-rouge">n</code> 的值即可求出所有符合条件的输入 x，如果嫌麻烦，也可以直接把运行这段代码来找符合条件的值。</p>

<p>最终符合条件的值是 <code class="language-plaintext highlighter-rouge">0,1,3,7</code>，输入这四个值中的任意一个作为第一个数字输入，均可成功拆除炸弹。</p>

<h4 id="0x15-phase_5">
<a class="anchor" href="#0x15-phase_5" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.5 phase_5</h4>

<p>进入到 <code class="language-plaintext highlighter-rouge">phase_5</code> 之后，注意到下面这一段汇编代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401078</span><span class="p">:</span>	<span class="mi">31</span> <span class="nx">c0</span>                	<span class="nx">xor</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40107</span><span class="nx">a</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">9</span><span class="nx">c</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40131</span><span class="nx">b</span> <span class="o">&lt;</span><span class="nx">string_length</span><span class="o">&gt;</span>
  <span class="mi">40107</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">06</span>             	<span class="nx">cmp</span>    <span class="nx">$0x6</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401082</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">4</span><span class="nx">e</span>                	<span class="nx">je</span>     <span class="mi">4010</span><span class="nx">d2</span> <span class="o">&lt;</span><span class="nx">phase_5</span><span class="o">+</span><span class="mh">0x70</span><span class="o">&gt;</span>
  <span class="mi">401084</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">b1</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>其中 <code class="language-plaintext highlighter-rouge">xor %eax,%eax</code> 其实等价于将 <code class="language-plaintext highlighter-rouge">%eax</code> 置零，然后通过 <code class="language-plaintext highlighter-rouge">string_length</code> 来判断输入的字符串长度，后面通过 <code class="language-plaintext highlighter-rouge">cmp $0x6,%eax</code> 比较字符串长度和 <code class="language-plaintext highlighter-rouge">6</code> 的大小，如果不相等则会引发爆炸，如果相等，可以跳到地址为 <code class="language-plaintext highlighter-rouge">0x4010d2</code> 继续执行。</p>

<p>继续往后执行，可以发现会进入到下面这一段循环代码中</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">40108</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">0</span><span class="nx">f</span> <span class="nx">b6</span> <span class="mi">0</span><span class="nx">c</span> <span class="mi">03</span>          	<span class="nx">movzbl</span> <span class="p">(</span><span class="o">%</span><span class="nx">rbx</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">40108</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">88</span> <span class="mi">0</span><span class="nx">c</span> <span class="mi">24</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">cl</span><span class="p">,(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">401092</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">14</span> <span class="mi">24</span>          	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rdx</span>
  <span class="mi">401096</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">e2</span> <span class="mi">0</span><span class="nx">f</span>             	<span class="nx">and</span>    <span class="nx">$0xf</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401099</span><span class="p">:</span>	<span class="mi">0</span><span class="nx">f</span> <span class="nx">b6</span> <span class="mi">92</span> <span class="nx">b0</span> <span class="mi">24</span> <span class="mi">40</span> <span class="mi">00</span> 	<span class="nx">movzbl</span> <span class="mh">0x4024b0</span><span class="p">(</span><span class="o">%</span><span class="nx">rdx</span><span class="p">),</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">4010</span><span class="nx">a0</span><span class="p">:</span>	<span class="mi">88</span> <span class="mi">54</span> <span class="mi">04</span> <span class="mi">10</span>          	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">dl</span><span class="p">,</span><span class="mh">0x10</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
  <span class="mi">4010</span><span class="nx">a4</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c0</span> <span class="mi">01</span>          	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4010</span><span class="nx">a8</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">f8</span> <span class="mi">06</span>          	<span class="nx">cmp</span>    <span class="nx">$0x6</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4010</span><span class="nx">ac</span><span class="p">:</span>	<span class="mi">75</span> <span class="nx">dd</span>                	<span class="nx">jne</span>    <span class="mi">40108</span><span class="nx">b</span> <span class="o">&lt;</span><span class="nx">phase_5</span><span class="o">+</span><span class="mh">0x29</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>我们可以逐步分析每一行代码的含义，其中 <code class="language-plaintext highlighter-rouge">%rbx</code> 表示输入的字符串开头，在 <code class="language-plaintext highlighter-rouge">gdb</code>  中运行 <code class="language-plaintext highlighter-rouge">p %rax</code> 获得初始值是 <code class="language-plaintext highlighter-rouge">0</code>，那么这里相当于首先把输入字符串的第一个字符放到寄存器 <code class="language-plaintext highlighter-rouge">%ecx</code> 中；</p>

<p>接着两行 <code class="language-plaintext highlighter-rouge">mov</code> 指令将 <code class="language-plaintext highlighter-rouge">%ecx</code> 的最低 <code class="language-plaintext highlighter-rouge">8</code> 位寄存器 <code class="language-plaintext highlighter-rouge">%cl</code> 的结果放到寄存器 <code class="language-plaintext highlighter-rouge">%rdx</code> 中，因为不能直接从一个寄存器到另外一个寄存器，所以中间需要一次内存的转换，最终 <code class="language-plaintext highlighter-rouge">%rdx</code> 里面存放了刚才获得的字符；</p>

<p>下面一条指令 <code class="language-plaintext highlighter-rouge">and $0xf,%edx</code> 会将 <code class="language-plaintext highlighter-rouge">%edx</code> 在 <code class="language-plaintext highlighter-rouge">4</code> 位之后的值全部设为 <code class="language-plaintext highlighter-rouge">0</code>，因为 <code class="language-plaintext highlighter-rouge">0xf</code> 转换成二进制是 <code class="language-plaintext highlighter-rouge">0b1111</code>；</p>

<p>然后程序会以地址 <code class="language-plaintext highlighter-rouge">0x4024b0</code> 为起点，计算移动之后的地址所指向的内容，用寄存器 <code class="language-plaintext highlighter-rouge">%edx</code> 进行保存，可以通过在 <code class="language-plaintext highlighter-rouge">gdb</code> 中访问这个地址所对应的内存，得到下面的结果</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">x</span> <span class="o">/</span><span class="nx">s</span> <span class="mh">0x4024b0</span>
<span class="mh">0x4024b0</span> <span class="o">&lt;</span><span class="nx">array</span><span class="p">.</span><span class="mi">3449</span><span class="o">&gt;</span><span class="p">:</span>  <span class="dl">"</span><span class="s2">maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?</span><span class="dl">"</span>
</code></pre></div></div>

<p>最后程序会将寄存器 <code class="language-plaintext highlighter-rouge">%edx</code> 的低 <code class="language-plaintext highlighter-rouge">8</code> 位寄存器 <code class="language-plaintext highlighter-rouge">%dl</code> 中的值放到地址为 <code class="language-plaintext highlighter-rouge">0x10(%rsp,%rax,1)</code> 的内存中，接着继续遍历后续的字符，直到遍历完输入的 <code class="language-plaintext highlighter-rouge">6</code> 个字符为止。</p>

<p>直到此刻位置，我们仍然不清楚程序的要求，按照上面的流程，会根据输入字符的编码数字，经过一系列运算得到一个 <code class="language-plaintext highlighter-rouge">offset</code>，最后根据这个 <code class="language-plaintext highlighter-rouge">offset</code> 从一个比较长的字符串里面获得对应的字符，接下来继续跟着程序往后运行。</p>

<p>在跳出循环好，代码会进入到这个地方</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">4010</span><span class="nx">ae</span><span class="p">:</span>	<span class="nx">c6</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">16</span> <span class="mi">00</span>       	<span class="nx">movb</span>   <span class="nx">$0x0</span><span class="p">,</span><span class="mh">0x16</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">)</span>
  <span class="mi">4010</span><span class="nx">b3</span><span class="p">:</span>	<span class="nx">be</span> <span class="mi">5</span><span class="nx">e</span> <span class="mi">24</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x40245e</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">4010</span><span class="nx">b8</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">10</span>       	<span class="nx">lea</span>    <span class="mh">0x10</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">4010</span><span class="nx">bd</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">76</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">401338</span> <span class="o">&lt;</span><span class="nx">strings_not_equal</span><span class="o">&gt;</span>
  <span class="mi">4010</span><span class="nx">c2</span><span class="p">:</span>	<span class="mi">85</span> <span class="nx">c0</span>                	<span class="nx">test</span>   <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">4010</span><span class="nx">c4</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">13</span>                	<span class="nx">je</span>     <span class="mi">4010</span><span class="nx">d9</span> <span class="o">&lt;</span><span class="nx">phase_5</span><span class="o">+</span><span class="mh">0x77</span><span class="o">&gt;</span>
  <span class="mi">4010</span><span class="nx">c6</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">6</span><span class="nx">f</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>首先获得地址为 <code class="language-plaintext highlighter-rouge">$0x40245e</code> 的字符串，用寄存器 <code class="language-plaintext highlighter-rouge">%esi</code> 保存它的起始地址，同时在 <code class="language-plaintext highlighter-rouge">%rdi</code> 中保存了刚才循环生成的字符串，接着调用 <code class="language-plaintext highlighter-rouge">strings_not_equal</code> ，通过名字可以知道它是在判断这两个字符串是否相等。</p>

<p>通过 <code class="language-plaintext highlighter-rouge">gdb</code> 查看以地址 <code class="language-plaintext highlighter-rouge">$0x40245e</code> 为起点的字符串是</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">x</span> <span class="o">/</span><span class="nx">s</span> <span class="mh">0x40245e</span>
<span class="mh">0x40245e</span><span class="p">:</span>       <span class="dl">"</span><span class="s2">flyers</span><span class="dl">"</span>
</code></pre></div></div>

<p>最终的问题就变成了要从序列中 <code class="language-plaintext highlighter-rouge">maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?</code> 中选择对应位置的字符，使得最终字符是 <code class="language-plaintext highlighter-rouge">flyers</code>，这里存在多种选择方式，比如 <code class="language-plaintext highlighter-rouge">l</code> 在序列中出现在了多个位置，我们可以选择第一次出现对应字符的位置。</p>

<p>重新查看上面对输入字符的运算流程，每次输入的字符被转变成二进制，最终只会保留最低的 <code class="language-plaintext highlighter-rouge">4</code> 位，比如输入 <code class="language-plaintext highlighter-rouge">a=97=1100001</code>，经过计算最后会变成 <code class="language-plaintext highlighter-rouge">0001</code>，这其实相当于进行 <code class="language-plaintext highlighter-rouge">mod 16</code> 的运算。</p>

<p>分析 <code class="language-plaintext highlighter-rouge">flyers</code> 分别在序列中最先出现的位置是 <code class="language-plaintext highlighter-rouge">9, 15, 14, 5, 6, 7</code>，如果我们都输入小写字母，那么起始点就是 <code class="language-plaintext highlighter-rouge">96</code>，因为在 <code class="language-plaintext highlighter-rouge">anscii</code> 编码中 <code class="language-plaintext highlighter-rouge">a=97</code>，比他小且最靠近它的 <code class="language-plaintext highlighter-rouge">16</code> 的倍数就是 <code class="language-plaintext highlighter-rouge">96</code>，所以上面的值分别加上 <code class="language-plaintext highlighter-rouge">96</code> 可以得到下面的结果 <code class="language-plaintext highlighter-rouge">105, 111, 110, 101, 102, 103</code>，再将其转换成字符可以获得最后输入的 <code class="language-plaintext highlighter-rouge">6</code> 个字符分别是 <code class="language-plaintext highlighter-rouge">ionefg</code>。</p>

<h4 id="0x16-phase_6">
<a class="anchor" href="#0x16-phase_6" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.6 phase_6</h4>

<p>第 6 阶段会比较复杂，主要考察了 <code class="language-plaintext highlighter-rouge">linked list</code> 这种数据结构，我们还是像之前一样，逐步分析。</p>

<p>首先进入的代码如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401100</span><span class="p">:</span>	<span class="mi">49</span> <span class="mi">89</span> <span class="nx">e5</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">r13</span>
  <span class="mi">401103</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">e6</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rsi</span>
  <span class="mi">401106</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">51</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40145</span><span class="nx">c</span> <span class="o">&lt;</span><span class="nx">read_six_numbers</span><span class="o">&gt;</span>
  <span class="mi">40110</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">49</span> <span class="mi">89</span> <span class="nx">e6</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">r14</span>
  <span class="mi">40110</span><span class="nx">e</span><span class="p">:</span>	<span class="mi">41</span> <span class="nx">bc</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>    	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
  <span class="mi">401114</span><span class="p">:</span>	<span class="mi">4</span><span class="nx">c</span> <span class="mi">89</span> <span class="nx">ed</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">r13</span><span class="p">,</span><span class="o">%</span><span class="nx">rbp</span>
  <span class="mi">401117</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">45</span> <span class="mi">00</span>          	<span class="nx">mov</span>    <span class="mh">0x0</span><span class="p">(</span><span class="o">%</span><span class="nx">r13</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40111</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">e8</span> <span class="mi">01</span>             	<span class="nx">sub</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40111</span><span class="nx">e</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">05</span>             	<span class="nx">cmp</span>    <span class="nx">$0x5</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401121</span><span class="p">:</span>	<span class="mi">76</span> <span class="mi">05</span>                	<span class="nx">jbe</span>    <span class="mi">401128</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x34</span><span class="o">&gt;</span>
  <span class="mi">401123</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">12</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">401128</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">01</span>          	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
</code></pre></div></div>

<p>先通过 <code class="language-plaintext highlighter-rouge">read_six_numbers</code> 读取 <code class="language-plaintext highlighter-rouge">6</code> 个数字，而 <code class="language-plaintext highlighter-rouge">$rsp, $r13, $rsi</code> 这三个寄存器里面都存放了相同的地址，可以通过在 <code class="language-plaintext highlighter-rouge">gdb</code> 中使用 <code class="language-plaintext highlighter-rouge">x /6 $rsi</code> 验证这里存放的是输入的 <code class="language-plaintext highlighter-rouge">6</code> 个数字的起始地址。</p>

<p><code class="language-plaintext highlighter-rouge">mov 0x0(%r13),%eax</code> 会将输入的第一个数字放到寄存器 <code class="language-plaintext highlighter-rouge">$eax</code> 中，后面会对他做 <code class="language-plaintext highlighter-rouge">-1</code> 的运算，然后和 <code class="language-plaintext highlighter-rouge">0x5</code> 比较大小，必须要比他小或相等，否则炸弹会引爆，即输入的第一个数字必须要 <code class="language-plaintext highlighter-rouge">&lt;=6</code>。</p>

<p>然后代码会进入到下面的地方</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401128</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">01</span>          	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
  <span class="mi">40112</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">83</span> <span class="nx">fc</span> <span class="mi">06</span>          	<span class="nx">cmp</span>    <span class="nx">$0x6</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
  <span class="mi">401130</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">21</span>                	<span class="nx">je</span>     <span class="mi">401153</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x5f</span><span class="o">&gt;</span>
  <span class="mi">401132</span><span class="p">:</span>	<span class="mi">44</span> <span class="mi">89</span> <span class="nx">e3</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">r12d</span><span class="p">,</span><span class="o">%</span><span class="nx">ebx</span>
  <span class="mi">401135</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">63</span> <span class="nx">c3</span>             	<span class="nx">movslq</span> <span class="o">%</span><span class="nx">ebx</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">401138</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">04</span> <span class="mi">84</span>             	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40113</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">39</span> <span class="mi">45</span> <span class="mi">00</span>             	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="mh">0x0</span><span class="p">(</span><span class="o">%</span><span class="nx">rbp</span><span class="p">)</span>
  <span class="mi">40113</span><span class="nx">e</span><span class="p">:</span>	<span class="mi">75</span> <span class="mi">05</span>                	<span class="nx">jne</span>    <span class="mi">401145</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x51</span><span class="o">&gt;</span>
  <span class="mi">401140</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">f5</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">401145</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">c3</span> <span class="mi">01</span>             	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">ebx</span>
  <span class="mi">401148</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">fb</span> <span class="mi">05</span>             	<span class="nx">cmp</span>    <span class="nx">$0x5</span><span class="p">,</span><span class="o">%</span><span class="nx">ebx</span>
  <span class="mi">40114</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">e</span> <span class="nx">e8</span>                	<span class="nx">jle</span>    <span class="mi">401135</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x41</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>注意到前面的代码中将 <code class="language-plaintext highlighter-rouge">$r12d</code> 置为 <code class="language-plaintext highlighter-rouge">0</code>，然后这里会 <code class="language-plaintext highlighter-rouge">+1</code> 和 <code class="language-plaintext highlighter-rouge">6</code> 进行比较，如果相等则会直接跳到地址 <code class="language-plaintext highlighter-rouge">0x401153</code>，说明这是在遍历输入的 <code class="language-plaintext highlighter-rouge">6</code> 个数。</p>

<p><code class="language-plaintext highlighter-rouge">mov (%rsp,%rax,4),%eax</code> 不断遍历输入的数字，此时 <code class="language-plaintext highlighter-rouge">$rax=1</code>，所以是把第二个数字放到寄存器 <code class="language-plaintext highlighter-rouge">$eax</code> 中，然后和 <code class="language-plaintext highlighter-rouge">0x0(%rbp)</code> 进行比较，前面我们知道 <code class="language-plaintext highlighter-rouge">$rbp</code> 存放了第一个数字的地址，也可以在 <code class="language-plaintext highlighter-rouge">gdb</code> 中进行确认，所以这是将后面输入的数字都和第一个数字比较，需要他们不等，否则就会引爆炸弹。</p>

<p>跳出这个循环之后，会进入到下面这段代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401114</span><span class="p">:</span>	<span class="mi">4</span><span class="nx">c</span> <span class="mi">89</span> <span class="nx">ed</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">r13</span><span class="p">,</span><span class="o">%</span><span class="nx">rbp</span>
  <span class="mi">401117</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">45</span> <span class="mi">00</span>          	<span class="nx">mov</span>    <span class="mh">0x0</span><span class="p">(</span><span class="o">%</span><span class="nx">r13</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40111</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">e8</span> <span class="mi">01</span>             	<span class="nx">sub</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40111</span><span class="nx">e</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">05</span>             	<span class="nx">cmp</span>    <span class="nx">$0x5</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401121</span><span class="p">:</span>	<span class="mi">76</span> <span class="mi">05</span>                	<span class="nx">jbe</span>    <span class="mi">401128</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x34</span><span class="o">&gt;</span>
  <span class="mi">401123</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">12</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
  <span class="mi">401128</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">01</span>          	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
  <span class="mi">40112</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">41</span> <span class="mi">83</span> <span class="nx">fc</span> <span class="mi">06</span>          	<span class="nx">cmp</span>    <span class="nx">$0x6</span><span class="p">,</span><span class="o">%</span><span class="nx">r12d</span>
  <span class="mi">401130</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">21</span>                	<span class="nx">je</span>     <span class="mi">401153</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x5f</span><span class="o">&gt;</span>
  <span class="p">...</span>
  <span class="mi">40114</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">49</span> <span class="mi">83</span> <span class="nx">c5</span> <span class="mi">04</span>          	<span class="nx">add</span>    <span class="nx">$0x4</span><span class="p">,</span><span class="o">%</span><span class="nx">r13</span>
  <span class="mi">401151</span><span class="p">:</span>	<span class="nx">eb</span> <span class="nx">c1</span>                	<span class="nx">jmp</span>    <span class="mi">401114</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x20</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>首先会对 <code class="language-plaintext highlighter-rouge">$r13</code> 增加 <code class="language-plaintext highlighter-rouge">4</code>个字节，因为输入的是 <code class="language-plaintext highlighter-rouge">int</code>，所以这里等价于让 <code class="language-plaintext highlighter-rouge">$r13</code> 指向第二个输入的数字，然后跳转到地址 <code class="language-plaintext highlighter-rouge">0x401114</code>。</p>

<p>接着用 <code class="language-plaintext highlighter-rouge">$eax</code> 保留第二个数字，又跳到了第一段代码的地方，说明这里要求输入的所有数字都要 <code class="language-plaintext highlighter-rouge">&lt;=6</code>。</p>

<p>通过 <code class="language-plaintext highlighter-rouge">$r12d</code> 和 <code class="language-plaintext highlighter-rouge">6</code> 比较的大小来决定是否遍历完所有的数字，接着进入到上一个循环，判断后面的数字是否和当前数字相等，这里的当前数字是第二个输入的数字，所以上面的代码总结起来的需求是要输入 <code class="language-plaintext highlighter-rouge">6</code> 个数字，每个数字需要 <code class="language-plaintext highlighter-rouge">&lt;=6</code>，并且他们互相不相等。</p>

<p>然后代码会进行到下面这里</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401153</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">74</span> <span class="mi">24</span> <span class="mi">18</span>       	<span class="nx">lea</span>    <span class="mh">0x18</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rsi</span>
  <span class="mi">401158</span><span class="p">:</span>	<span class="mi">4</span><span class="nx">c</span> <span class="mi">89</span> <span class="nx">f0</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">r14</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">40115</span><span class="nx">b</span><span class="p">:</span>	<span class="nx">b9</span> <span class="mi">07</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x7</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">401160</span><span class="p">:</span>	<span class="mi">89</span> <span class="nx">ca</span>                	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">ecx</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401162</span><span class="p">:</span>	<span class="mi">2</span><span class="nx">b</span> <span class="mi">10</span>                	<span class="nx">sub</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">),</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401164</span><span class="p">:</span>	<span class="mi">89</span> <span class="mi">10</span>                	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">edx</span><span class="p">,(</span><span class="o">%</span><span class="nx">rax</span><span class="p">)</span>
  <span class="mi">401166</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c0</span> <span class="mi">04</span>          	<span class="nx">add</span>    <span class="nx">$0x4</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">40116</span><span class="nx">a</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">39</span> <span class="nx">f0</span>             	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">40116</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">75</span> <span class="nx">f1</span>                	<span class="nx">jne</span>    <span class="mi">401160</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x6c</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>注意到 <code class="language-plaintext highlighter-rouge">0x18</code> 在十进制下是 <code class="language-plaintext highlighter-rouge">24</code>，<code class="language-plaintext highlighter-rouge">$rsi</code> 地址在 <code class="language-plaintext highlighter-rouge">$rsp</code> 之后的 <code class="language-plaintext highlighter-rouge">24</code>个字节，刚好差了 <code class="language-plaintext highlighter-rouge">6</code> 个类型是 <code class="language-plaintext highlighter-rouge">int</code> 的输入。</p>

<p>这里会遍历输入的每一个数字，首先通过 <code class="language-plaintext highlighter-rouge">7-num</code> 获得结果，保存在 <code class="language-plaintext highlighter-rouge">$edx</code> 中，然后 <code class="language-plaintext highlighter-rouge">mov %edx,(%rax)</code> 将结果放回 <code class="language-plaintext highlighter-rouge">$rax</code> 指向的内存地址，接着 <code class="language-plaintext highlighter-rouge">add $0x4,%rax</code> 遍历下一个数字，所以整体流程类似于下面的代码</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">{};</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>

<p>继续运行，会进入到下面的代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401197</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">0</span><span class="nx">c</span> <span class="mi">34</span>             	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">40119</span><span class="nx">a</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f9</span> <span class="mi">01</span>             	<span class="nx">cmp</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">ecx</span>
  <span class="mi">40119</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">e</span> <span class="nx">e4</span>                	<span class="nx">jle</span>    <span class="mi">401183</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x8f</span><span class="o">&gt;</span>
  <span class="mi">40119</span><span class="nx">f</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">4011</span><span class="nx">a4</span><span class="p">:</span>	<span class="nx">ba</span> <span class="nx">d0</span> <span class="mi">32</span> <span class="mi">60</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x6032d0</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">4011</span><span class="nx">a9</span><span class="p">:</span>	<span class="nx">eb</span> <span class="nx">cb</span>                	<span class="nx">jmp</span>    <span class="mi">401176</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x82</span><span class="o">&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">$rsi</code> 初始为 <code class="language-plaintext highlighter-rouge">0</code>，<code class="language-plaintext highlighter-rouge">mov (%rsp,%rsi,1),%ecx</code> 将第一个数字放到 <code class="language-plaintext highlighter-rouge">$ecx</code> 中，然后和 <code class="language-plaintext highlighter-rouge">1</code> 进行比较，如果 <code class="language-plaintext highlighter-rouge">&lt;=1</code>，进入地址 <code class="language-plaintext highlighter-rouge">0x401183</code> 这个位置，否则往后执行，会进入 <code class="language-plaintext highlighter-rouge">0x401176</code> 这个地址。</p>

<p>注意到<code class="language-plaintext highlighter-rouge">mov $0x6032d0,%edx</code> 将地址放到寄存器 <code class="language-plaintext highlighter-rouge">$edx</code> 中，可以通过 <code class="language-plaintext highlighter-rouge">x $edx</code> 查看其中的内容如下 <code class="language-plaintext highlighter-rouge">0x6032d0 &lt;node1&gt;: 0x0000014c</code>，不过目前我们还不知道这个数据结构的含义。</p>

<p>继续运行到地址是 <code class="language-plaintext highlighter-rouge">0x401176</code> 的代码如下</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401176</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">52</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rdx</span><span class="p">),</span><span class="o">%</span><span class="nx">rdx</span>
  <span class="mi">40117</span><span class="nx">a</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">c0</span> <span class="mi">01</span>             	<span class="nx">add</span>    <span class="nx">$0x1</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40117</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">39</span> <span class="nx">c8</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">ecx</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40117</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">75</span> <span class="nx">f5</span>                	<span class="nx">jne</span>    <span class="mi">401176</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x82</span><span class="o">&gt;</span>
  <span class="mi">401181</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">05</span>                	<span class="nx">jmp</span>    <span class="mi">401188</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0x94</span><span class="o">&gt;</span>
  <span class="mi">401183</span><span class="p">:</span>	<span class="nx">ba</span> <span class="nx">d0</span> <span class="mi">32</span> <span class="mi">60</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x6032d0</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401188</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="mi">54</span> <span class="mi">74</span> <span class="mi">20</span>       	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rdx</span><span class="p">,</span><span class="mh">0x20</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">,</span><span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">$rdx</code> 表示 <code class="language-plaintext highlighter-rouge">node1</code>，开始先对地址 <code class="language-plaintext highlighter-rouge">+8</code>，然后 <code class="language-plaintext highlighter-rouge">$eax+1</code> 和 <code class="language-plaintext highlighter-rouge">$ecx</code> 比较大小，如果小于 <code class="language-plaintext highlighter-rouge">$ecx</code> 则继续对 <code class="language-plaintext highlighter-rouge">node1</code> 地址 <code class="language-plaintext highlighter-rouge">+8</code>，而<code class="language-plaintext highlighter-rouge">$ecx==6</code> 表示输入的 <code class="language-plaintext highlighter-rouge">6</code> 个数字，先从第一个数字开始取。</p>

<p>通过 <code class="language-plaintext highlighter-rouge">x/24 $rdx</code> 可以看到下面的结果</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x6032d0</span> <span class="o">&lt;</span><span class="nx">node1</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x0000014c</span>      <span class="mh">0x00000001</span>      <span class="mh">0x006032e0</span>      <span class="mh">0x00000000</span>
<span class="mh">0x6032e0</span> <span class="o">&lt;</span><span class="nx">node2</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x000000a8</span>      <span class="mh">0x00000002</span>      <span class="mh">0x006032f0</span>      <span class="mh">0x00000000</span>
<span class="mh">0x6032f0</span> <span class="o">&lt;</span><span class="nx">node3</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x0000039c</span>      <span class="mh">0x00000003</span>      <span class="mh">0x00603300</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603300</span> <span class="o">&lt;</span><span class="nx">node4</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x000002b3</span>      <span class="mh">0x00000004</span>      <span class="mh">0x00603310</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603310</span> <span class="o">&lt;</span><span class="nx">node5</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x000001dd</span>      <span class="mh">0x00000005</span>      <span class="mh">0x00603320</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603320</span> <span class="o">&lt;</span><span class="nx">node6</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x000001bb</span>      <span class="mh">0x00000006</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>
</code></pre></div></div>

<p>注意到 <code class="language-plaintext highlighter-rouge">node1</code> 的第三个数字即为 <code class="language-plaintext highlighter-rouge">node2</code> 的开始地址，说明这是一个 <code class="language-plaintext highlighter-rouge">linked list</code>，而第一个数字标注节点的 <code class="language-plaintext highlighter-rouge">val</code>，比如  <code class="language-plaintext highlighter-rouge">node1</code> 里面的 <code class="language-plaintext highlighter-rouge">val</code> 是 <code class="language-plaintext highlighter-rouge">332</code>。</p>

<p>总结起来就是 <code class="language-plaintext highlighter-rouge">linked list</code> 初始地址为 <code class="language-plaintext highlighter-rouge">0x6032d0</code>，用户输入的 <code class="language-plaintext highlighter-rouge">6</code> 个数字，首先用 <code class="language-plaintext highlighter-rouge">7-</code>，然后遍历每个数字，数字决定了 <code class="language-plaintext highlighter-rouge">linked list</code> 向后移动的次数，最后将每次取到的 <code class="language-plaintext highlighter-rouge">node</code> 依次放到以 <code class="language-plaintext highlighter-rouge">0x20(%rsp)</code> 为起始地址的内存中。</p>

<p>接着会进行下面这段代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">4011</span><span class="nx">ab</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">5</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">20</span>       	<span class="nx">mov</span>    <span class="mh">0x20</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">4011</span><span class="nx">b0</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">44</span> <span class="mi">24</span> <span class="mi">28</span>       	<span class="nx">lea</span>    <span class="mh">0x28</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4011</span><span class="nx">b5</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">74</span> <span class="mi">24</span> <span class="mi">50</span>       	<span class="nx">lea</span>    <span class="mh">0x50</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rsi</span>
  <span class="mi">4011</span><span class="nx">ba</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">d9</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rbx</span><span class="p">,</span><span class="o">%</span><span class="nx">rcx</span>
  <span class="mi">4011</span><span class="nx">bd</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">10</span>             	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">),</span><span class="o">%</span><span class="nx">rdx</span>
  <span class="mi">4011</span><span class="nx">c0</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="mi">51</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rdx</span><span class="p">,</span><span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rcx</span><span class="p">)</span>
  <span class="mi">4011</span><span class="nx">c4</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c0</span> <span class="mi">08</span>          	<span class="nx">add</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4011</span><span class="nx">c8</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">39</span> <span class="nx">f0</span>             	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">rsi</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4011</span><span class="nx">cb</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">05</span>                	<span class="nx">je</span>     <span class="mi">4011</span><span class="nx">d2</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0xde</span><span class="o">&gt;</span>
  <span class="mi">4011</span><span class="nx">cd</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">d1</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rdx</span><span class="p">,</span><span class="o">%</span><span class="nx">rcx</span>
  <span class="mi">4011</span><span class="nx">d0</span><span class="p">:</span>	<span class="nx">eb</span> <span class="nx">eb</span>                	<span class="nx">jmp</span>    <span class="mi">4011</span><span class="nx">bd</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0xc9</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>这段代码是修改每个 <code class="language-plaintext highlighter-rouge">node</code> 指向的内容，重新建立新的 <code class="language-plaintext highlighter-rouge">linked list</code>，让取到的前一个 <code class="language-plaintext highlighter-rouge">node</code> 指向取到的下一个 <code class="language-plaintext highlighter-rouge">node</code> 的地址，可以通过 <code class="language-plaintext highlighter-rouge">mov  %rdx,0x8(%rcx)</code> 看出来，同时 <code class="language-plaintext highlighter-rouge">add $0x8,%rax</code> 即为不断的向后遍历 <code class="language-plaintext highlighter-rouge">linked list</code>。</p>

<p>最后会运行到下面这段代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">4011</span><span class="nx">d2</span><span class="p">:</span>	<span class="mi">48</span> <span class="nx">c7</span> <span class="mi">42</span> <span class="mi">08</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> 	<span class="nx">movq</span>   <span class="nx">$0x0</span><span class="p">,</span><span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rdx</span><span class="p">)</span>
  <span class="mi">4011</span><span class="nx">d9</span><span class="p">:</span>	<span class="mi">00</span> 
  <span class="mi">4011</span><span class="nx">da</span><span class="p">:</span>	<span class="nx">bd</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x5</span><span class="p">,</span><span class="o">%</span><span class="nx">ebp</span>
  <span class="mi">4011</span><span class="nx">df</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">43</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rbx</span><span class="p">),</span><span class="o">%</span><span class="nx">rax</span>
  <span class="mi">4011</span><span class="nx">e3</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">00</span>                	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">4011</span><span class="nx">e5</span><span class="p">:</span>	<span class="mi">39</span> <span class="mi">03</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,(</span><span class="o">%</span><span class="nx">rbx</span><span class="p">)</span>
  <span class="mi">4011</span><span class="nx">e7</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">d</span> <span class="mi">05</span>                	<span class="nx">jge</span>    <span class="mi">4011</span><span class="nx">ee</span> <span class="o">&lt;</span><span class="nx">phase_6</span><span class="o">+</span><span class="mh">0xfa</span><span class="o">&gt;</span>
  <span class="mi">4011</span><span class="nx">e9</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">4</span><span class="nx">c</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>这段代码最后决定了是否会引爆炸弹，<code class="language-plaintext highlighter-rouge">$rbx</code> 是第一次取到的 <code class="language-plaintext highlighter-rouge">node</code>，<code class="language-plaintext highlighter-rouge">0x8(%rbx)</code> 是第二次取到的 <code class="language-plaintext highlighter-rouge">node</code>，这里的比较需要前一次取到的 <code class="language-plaintext highlighter-rouge">nodel</code> 里面的值比第二次取到的 <code class="language-plaintext highlighter-rouge">node</code> 中的值大，否则炸弹爆炸。</p>

<p>看到这里，要求已经很清楚了，我们需要输入 <code class="language-plaintext highlighter-rouge">6</code> 个数字，每个数字 <code class="language-plaintext highlighter-rouge">7-</code> 之后表示取 <code class="language-plaintext highlighter-rouge">linked list</code> 中的第几个 <code class="language-plaintext highlighter-rouge">node</code>，依次取出来值之后，需要降序排列，所以通过比较上面 <code class="language-plaintext highlighter-rouge">linked list</code> 不同 <code class="language-plaintext highlighter-rouge">node</code> 的值，最终需要输入的结果为 <code class="language-plaintext highlighter-rouge">4 3 2 1 6 5</code>。</p>

<h4 id="0x17-secret_phase">
<a class="anchor" href="#0x17-secret_phase" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x1.7 secret_phase</h4>

<p>除了标准的阶段外，代码中还藏了一个秘密阶段，通过 <code class="language-plaintext highlighter-rouge">bomb.c</code> 的注释可以发现这个秘密，在汇编代码中也可以搜索到这个阶段，不过想要进入这个阶段并不容易，下面我们来讲一下 secret_phase.</p>

<p>在汇编代码中搜索 <code class="language-plaintext highlighter-rouge">secret_phase</code> 会找到如何函数在 <code class="language-plaintext highlighter-rouge">phase_defused</code> 中，接着看看这一段代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">4015</span><span class="nx">f0</span><span class="p">:</span>	<span class="nx">be</span> <span class="mi">19</span> <span class="mi">26</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x402619</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">4015</span><span class="nx">f5</span><span class="p">:</span>	<span class="nx">bf</span> <span class="mi">70</span> <span class="mi">38</span> <span class="mi">60</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x603870</span><span class="p">,</span><span class="o">%</span><span class="nx">edi</span>
  <span class="mi">4015</span><span class="nx">fa</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">f1</span> <span class="nx">f5</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">bf0</span> <span class="o">&lt;</span><span class="nx">__isoc99_sscanf</span><span class="p">@</span><span class="nd">plt</span><span class="o">&gt;</span>
  <span class="mi">4015</span><span class="nx">ff</span><span class="p">:</span>	<span class="mi">83</span> <span class="nx">f8</span> <span class="mi">03</span>             	<span class="nx">cmp</span>    <span class="nx">$0x3</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401602</span><span class="p">:</span>	<span class="mi">75</span> <span class="mi">31</span>                	<span class="nx">jne</span>    <span class="mi">401635</span> <span class="o">&lt;</span><span class="nx">phase_defused</span><span class="o">+</span><span class="mh">0x71</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>这段代码开始调用了 <code class="language-plaintext highlighter-rouge">sscanf</code> ，它的两个参数分别为 <code class="language-plaintext highlighter-rouge">$esi</code> 和 <code class="language-plaintext highlighter-rouge">$edi</code>，可以通过 <code class="language-plaintext highlighter-rouge">x/s 0x402619, x/s 0x603870</code> 查看他们的具体数值分别是 <code class="language-plaintext highlighter-rouge">%d %d %s</code> 和 <code class="language-plaintext highlighter-rouge">&lt;input_strings+240&gt;: "1 0"</code>，且 <code class="language-plaintext highlighter-rouge">$eax</code> 作为 <code class="language-plaintext highlighter-rouge">sscanf</code> 的返回值，结果为 <code class="language-plaintext highlighter-rouge">2</code>，接着要和 <code class="language-plaintext highlighter-rouge">3</code> 进行比较，如果不相等的话，则会跳到最后退出，这时就无法进入 <code class="language-plaintext highlighter-rouge">secret_phase</code>。</p>

<p>查阅一下 <code class="language-plaintext highlighter-rouge">sscanf</code> 函数，发现它会从一个字符串的开始位置检索特定的格式，这里检索的字符串为 <code class="language-plaintext highlighter-rouge">"1 0"</code>，格式是 <code class="language-plaintext highlighter-rouge">%d %d %s</code>，发现这里检索的字符串缺少最后一部分字符串输入，只有前两个数字的输入。</p>

<p>另外可以发现 <code class="language-plaintext highlighter-rouge">"1 0"</code> 是第 <code class="language-plaintext highlighter-rouge">4</code> 个输入，从这里知道应该再对输入一个字符串，不过具体输入什么内容还要继续往后看。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401604</span><span class="p">:</span>	<span class="nx">be</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">40</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x402622</span><span class="p">,</span><span class="o">%</span><span class="nx">esi</span>
  <span class="mi">401609</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">d</span> <span class="mi">7</span><span class="nx">c</span> <span class="mi">24</span> <span class="mi">10</span>       	<span class="nx">lea</span>    <span class="mh">0x10</span><span class="p">(</span><span class="o">%</span><span class="nx">rsp</span><span class="p">),</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">40160</span><span class="nx">e</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">25</span> <span class="nx">fd</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">401338</span> <span class="o">&lt;</span><span class="nx">strings_not_equal</span><span class="o">&gt;</span>
  <span class="mi">401613</span><span class="p">:</span>	<span class="mi">85</span> <span class="nx">c0</span>                	<span class="nx">test</span>   <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401615</span><span class="p">:</span>	<span class="mi">75</span> <span class="mi">1</span><span class="nx">e</span>                	<span class="nx">jne</span>    <span class="mi">401635</span> <span class="o">&lt;</span><span class="nx">phase_defused</span><span class="o">+</span><span class="mh">0x71</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>发现这里调用了 <code class="language-plaintext highlighter-rouge">strings_not_equal</code> 这个函数对输入字符串进行判断，通过 <code class="language-plaintext highlighter-rouge">x /s 0x402622</code> 发现结果为 <code class="language-plaintext highlighter-rouge">DrEvil</code>，所以我们在第 <code class="language-plaintext highlighter-rouge">4</code> 个输入的地方加上这个字符串即可进入到 <code class="language-plaintext highlighter-rouge">secret_phase</code>.</p>

<p>进入 <code class="language-plaintext highlighter-rouge">secret_phase</code> 后需要输入一个数字，先观察下面这段代码</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="mi">401255</span><span class="p">:</span>	<span class="nx">e8</span> <span class="mi">76</span> <span class="nx">f9</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">400</span><span class="nx">bd0</span> <span class="o">&lt;</span><span class="nx">strtol</span><span class="p">@</span><span class="nd">plt</span><span class="o">&gt;</span>
  <span class="mi">40125</span><span class="nx">a</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">89</span> <span class="nx">c3</span>             	<span class="nx">mov</span>    <span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="o">%</span><span class="nx">rbx</span>
  <span class="mi">40125</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">40</span> <span class="nx">ff</span>             	<span class="nx">lea</span>    <span class="o">-</span><span class="mh">0x1</span><span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401260</span><span class="p">:</span>	<span class="mi">3</span><span class="nx">d</span> <span class="nx">e8</span> <span class="mi">03</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">cmp</span>    <span class="nx">$0x3e8</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401265</span><span class="p">:</span>	<span class="mi">76</span> <span class="mi">05</span>                	<span class="nx">jbe</span>    <span class="mi">40126</span><span class="nx">c</span> <span class="o">&lt;</span><span class="nx">secret_phase</span><span class="o">+</span><span class="mh">0x2a</span><span class="o">&gt;</span>
  <span class="mi">401267</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">ce</span> <span class="mi">01</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">callq</span>  <span class="mi">40143</span><span class="nx">a</span> <span class="o">&lt;</span><span class="nx">explode_bomb</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>这里调用了 <code class="language-plaintext highlighter-rouge">strtol</code> 这个函数，对输入的字符串进行长整数的转换并返回结果，接着通过 <code class="language-plaintext highlighter-rouge">lea -0x1(%rax),%eax</code> 执行一个 <code class="language-plaintext highlighter-rouge">-1</code> 操作，然后和 <code class="language-plaintext highlighter-rouge">0x3e8</code> 进行比较，这里转换成十进制就是 <code class="language-plaintext highlighter-rouge">1000</code>，所以要求输入的数字要 <code class="language-plaintext highlighter-rouge">&lt;=1001</code>.</p>

<p>接着发现在 <code class="language-plaintext highlighter-rouge">secret_phase</code> 中调用了 <code class="language-plaintext highlighter-rouge">fun7</code>，只需要函数返回值等于 <code class="language-plaintext highlighter-rouge">2</code> 即可解除炸弹，先找到 <code class="language-plaintext highlighter-rouge">func7</code> 对应的代码。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">0000000000401204</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="mi">401204</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">ec</span> <span class="mi">08</span>          	<span class="nx">sub</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">401208</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">85</span> <span class="nx">ff</span>             	<span class="nx">test</span>   <span class="o">%</span><span class="nx">rdi</span><span class="p">,</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">40120</span><span class="nx">b</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">2</span><span class="nx">b</span>                	<span class="nx">je</span>     <span class="mi">401238</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">+</span><span class="mh">0x34</span><span class="o">&gt;</span>
  <span class="mi">40120</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">b</span> <span class="mi">17</span>                	<span class="nx">mov</span>    <span class="p">(</span><span class="o">%</span><span class="nx">rdi</span><span class="p">),</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">40120</span><span class="nx">f</span><span class="p">:</span>	<span class="mi">39</span> <span class="nx">f2</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">esi</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401211</span><span class="p">:</span>	<span class="mi">7</span><span class="nx">e</span> <span class="mi">0</span><span class="nx">d</span>                	<span class="nx">jle</span>    <span class="mi">401220</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">+</span><span class="mh">0x1c</span><span class="o">&gt;</span>
  <span class="mi">401213</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">7</span><span class="nx">f</span> <span class="mi">08</span>          	<span class="nx">mov</span>    <span class="mh">0x8</span><span class="p">(</span><span class="o">%</span><span class="nx">rdi</span><span class="p">),</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">401217</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">e8</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">401204</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">&gt;</span>
  <span class="mi">40121</span><span class="nx">c</span><span class="p">:</span>	<span class="mi">01</span> <span class="nx">c0</span>                	<span class="nx">add</span>    <span class="o">%</span><span class="nx">eax</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40121</span><span class="nx">e</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">1</span><span class="nx">d</span>                	<span class="nx">jmp</span>    <span class="mi">40123</span><span class="nx">d</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">+</span><span class="mh">0x39</span><span class="o">&gt;</span>
  <span class="mi">401220</span><span class="p">:</span>	<span class="nx">b8</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>       	<span class="nx">mov</span>    <span class="nx">$0x0</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401225</span><span class="p">:</span>	<span class="mi">39</span> <span class="nx">f2</span>                	<span class="nx">cmp</span>    <span class="o">%</span><span class="nx">esi</span><span class="p">,</span><span class="o">%</span><span class="nx">edx</span>
  <span class="mi">401227</span><span class="p">:</span>	<span class="mi">74</span> <span class="mi">14</span>                	<span class="nx">je</span>     <span class="mi">40123</span><span class="nx">d</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">+</span><span class="mh">0x39</span><span class="o">&gt;</span>
  <span class="mi">401229</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">8</span><span class="nx">b</span> <span class="mi">7</span><span class="nx">f</span> <span class="mi">10</span>          	<span class="nx">mov</span>    <span class="mh">0x10</span><span class="p">(</span><span class="o">%</span><span class="nx">rdi</span><span class="p">),</span><span class="o">%</span><span class="nx">rdi</span>
  <span class="mi">40122</span><span class="nx">d</span><span class="p">:</span>	<span class="nx">e8</span> <span class="nx">d2</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">callq</span>  <span class="mi">401204</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">&gt;</span>
  <span class="mi">401232</span><span class="p">:</span>	<span class="mi">8</span><span class="nx">d</span> <span class="mi">44</span> <span class="mi">00</span> <span class="mi">01</span>          	<span class="nx">lea</span>    <span class="mh">0x1</span><span class="p">(</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="o">%</span><span class="nx">rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">401236</span><span class="p">:</span>	<span class="nx">eb</span> <span class="mi">05</span>                	<span class="nx">jmp</span>    <span class="mi">40123</span><span class="nx">d</span> <span class="o">&lt;</span><span class="nx">fun7</span><span class="o">+</span><span class="mh">0x39</span><span class="o">&gt;</span>
  <span class="mi">401238</span><span class="p">:</span>	<span class="nx">b8</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span> <span class="nx">ff</span>       	<span class="nx">mov</span>    <span class="nx">$0xffffffff</span><span class="p">,</span><span class="o">%</span><span class="nx">eax</span>
  <span class="mi">40123</span><span class="nx">d</span><span class="p">:</span>	<span class="mi">48</span> <span class="mi">83</span> <span class="nx">c4</span> <span class="mi">08</span>          	<span class="nx">add</span>    <span class="nx">$0x8</span><span class="p">,</span><span class="o">%</span><span class="nx">rsp</span>
  <span class="mi">401241</span><span class="p">:</span>	<span class="nx">c3</span>                   	<span class="nx">retq</span>   
</code></pre></div></div>
<p>发现这是一个递归函数，其中返回的地方有 <code class="language-plaintext highlighter-rouge">3</code> 个，分别是 <code class="language-plaintext highlighter-rouge">add  %eax,%eax</code>, <code class="language-plaintext highlighter-rouge">mov  $0x0,%eax</code> 和 <code class="language-plaintext highlighter-rouge">lea  0x1(%rax,%rax,1),%eax</code>，所以递归调用 <code class="language-plaintext highlighter-rouge">fun7</code>，第一次返回 <code class="language-plaintext highlighter-rouge">1</code>，第二次 <code class="language-plaintext highlighter-rouge">2*$eax</code> 即可满足条件。</p>

<p>下面分析一下函数递归调用前的行为，发现有这两个地方 <code class="language-plaintext highlighter-rouge">mov 0x8(%rdi),%rdi</code> 和 <code class="language-plaintext highlighter-rouge">mov  0x10(%rdi),%rdi</code>，通过 <code class="language-plaintext highlighter-rouge">gdb</code> 去查看 <code class="language-plaintext highlighter-rouge">$rdi</code> 地址所指向的内容 <code class="language-plaintext highlighter-rouge">x/24 $rdi</code>，会发现这是一个二叉树，第一个是节点的值，后面分别是左子树和右子树的地址。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mh">0x6030f0</span> <span class="o">&lt;</span><span class="nx">n1</span><span class="o">&gt;</span><span class="p">:</span>  <span class="mh">0x00000024</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00603110</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603100</span> <span class="o">&lt;</span><span class="nx">n1</span><span class="o">+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>       <span class="mh">0x00603130</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603110</span> <span class="o">&lt;</span><span class="nx">n21</span><span class="o">&gt;</span><span class="p">:</span> <span class="mh">0x00000008</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00603190</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603120</span> <span class="o">&lt;</span><span class="nx">n21</span><span class="o">+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>      <span class="mh">0x00603150</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603130</span> <span class="o">&lt;</span><span class="nx">n22</span><span class="o">&gt;</span><span class="p">:</span> <span class="mh">0x00000032</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00603170</span>      <span class="mh">0x00000000</span>
<span class="mh">0x603140</span> <span class="o">&lt;</span><span class="nx">n22</span><span class="o">+</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">:</span>      <span class="mh">0x006031b0</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>      <span class="mh">0x00000000</span>
</code></pre></div></div>

<p>画出二叉树的结构如下，需要返回结果是 <code class="language-plaintext highlighter-rouge">2</code>，那么第一次找左子树，第二次找右子树，这样第二次返回 <code class="language-plaintext highlighter-rouge">1</code>，第一次返回 <code class="language-plaintext highlighter-rouge">2*ret</code> 即可返回 <code class="language-plaintext highlighter-rouge">2</code>，所以最后的结果是 <code class="language-plaintext highlighter-rouge">0x16=22</code>。</p>

<p><img src="/blogpages/images/csapp-bomb/csapp_bomb_binary_tree.png" width="400"></p>

<h3 id="0x2-结语">
<a class="anchor" href="#0x2-%E7%BB%93%E8%AF%AD" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x2 结语</h3>

<p>通过本次实验流程，熟悉了汇编和寄存器相关的内容，对栈帧以及函数调用也有了更深的理解，考察了一些数据结构的内容，刚开始阅读汇编代码会比较困难，不过重要的是耐心，一行一行理解背后的原理也需要毅力，不过最后在成功地拆除了炸弹之后还是很要成就感的！</p>

<h3 id="0x3-reference">
<a class="anchor" href="#0x3-reference" aria-hidden="true"><span class="octicon octicon-link"></span></a>0x3 Reference</h3>

<ul>
  <li><a href="http://csapp.cs.cmu.edu/3e/labs.html">CS:APP3e, Bryant and O’Hallaron (cmu.edu)</a></li>
  <li><a href="https://www.bilibili.com/video/BV1iW411d7hd?p=7">【精校中英字幕】2015 CMU 15-213 CSAPP 深入理解计算机系统 课程视频_哔哩哔哩_bilibili</a></li>
  <li><a href="https://www.viseator.com/2017/06/21/CS_APP_BombLab/">深入理解计算机系统（CS:APP) - Bomb Lab 详解 viseator’s blog</a></li>
</ul>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="L1aoXingyu/blogpages"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blogpages/operation%20system/c/csapp/assembly/2022/02/13/csapp-bomb.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blogpages/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blogpages/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blogpages/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>I want to create some new things! Happy blogging &amp; coding... ❤ | Scenius</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/L1aoXingyu" target="_blank" title="L1aoXingyu"><svg class="svg-icon grey"><use xlink:href="/blogpages/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/xingyu_liao" target="_blank" title="xingyu_liao"><svg class="svg-icon grey"><use xlink:href="/blogpages/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
